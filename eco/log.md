# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–æ–≥–æ–≤ —Å –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä–æ–≤

## –í —Ñ–∞–π–ª–µ `/etc/rsyslog.conf` —Ä–∞—Å–∫–æ–º–µ–Ω—Ç–∏—Ä—É–µ–º —Ä–∞–∑–¥–µ–ª

```bash
module(load="imudp")
input(type="imudp" port="514")

module(load="imtcp")
input(type="imtcp" port="514")
```


## –°–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª–æ –ø—Ä–∏–µ–º–∞ –ª–æ–≥–æ–≤

–ö –ø—Ä–∏–º–µ—Ä—É —Ñ–∞–π–ª `/etc/rsyslog.d/router.conf` —Å–æ —Å–ª–µ–¥—É—é—â–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–∏—ã–º

```bash
$template RemLogs, "/opt/logs/%HOSTNAME%.log"
*.* ?RemLogs
```

---

### 1. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ `/etc/logrotate.d/router`

```bash
/opt/logs/*.log {
    size 10M
    compress
    copytruncate
    missingok
    notifempty
}
```

---

### 2. –°–æ–∑–¥–∞–π—Ç–µ –∫–∞—Å—Ç–æ–º–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–æ—Ç–∞—Ü–∏–∏

```bash
sudo nano /etc/systemd/system/logrotate-remote.service
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:

```ini
[Unit]
Description=Rotate remote logs (10MB threshold)

[Service]
Type=oneshot
ExecStart=/usr/sbin/logrotate /etc/logrotate.d/router
```

---

### 3. –°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–π–º–µ—Ä —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 1 –º–∏–Ω—É—Ç–∞

```bash
sudo nano /etc/systemd/system/logrotate-router.timer
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:

```ini
[Unit]
Description=Run remote log rotation every minute

[Timer]
OnBootSec=1min
OnUnitActiveSec=1min
AccuracySec=1s

[Install]
WantedBy=timers.target
```

> üîë `OnUnitActiveSec=1min` ‚Äî –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞.

---

### 4. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–∞–π–º–µ—Ä

```bash
# –ü–µ—Ä–µ—á–∏—Ç–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥–∏ systemd
sudo systemctl daemon-reload

# –í–∫–ª—é—á–∏—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–∞–π–º–µ—Ä
sudo systemctl enable --now logrotate-router.timer

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
systemctl list-timers | grep logrotate
```

–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:
```
Mon 2026-02-02 16:05:23 MSK  23s left   Mon 2026-02-02 16:04:23 MSK  36s ago   logrotate-remote.timer logrotate-remote.service
```



# 3.5 –ê–∫–∫–∞—É–Ω—Ç–∏–Ω–≥ (Syslog) (—Å—Ç—Ä.38 ER_UserGuide.pdf 2018)

–§—É–Ω–∫—Ü–∏–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

–§—É–Ω–∫—Ü–∏–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑—É—é—Ç—Å—è –ø—É—Ç–µ–º –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ä–æ–ª–∏ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º –∫–æ–º–∞–Ω–¥, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω –ø–æ —É—Å–º–æ—Ç—Ä–µ–Ω–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–§—É–Ω–∫—Ü–∏–∏ –∞–∫–∫–∞—É–Ω—Ç–∏–Ω–≥–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ –æ—Ç–ø—Ä–∞–≤–∫—É –ª–æ–≥-–¥–∞–Ω–Ω—ã—Ö –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Å –ø–æ–º–æ—â—å—é –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –≤ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä —Ñ—É–Ω–∫—Ü–∏–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ Syslog (rsyslog). 

–ö–æ–º–∞–Ω–¥–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ Syslog-—Å–æ–æ–±—â–µ–Ω–∏–π –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

`rsyslog host <address> {mgmt | vr {default | <VR_NAME>}}`

–ì–¥–µ address - —ç—Ç–æ IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –ª–æ–≥–∏. 

–í —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, —Å–æ–æ–±—â–µ–Ω–∏—è –º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ management-–ø–æ—Ä—Ç mgmt –∏–ª–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä vr {default | <VR_NAME>}, –≥–¥–µ –ø–∞—Ä–∞–º–µ—Ç—Ä VR_NAME —è–≤–ª—è–µ—Ç—Å—è –∏–º–µ–Ω–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞, –∞ default –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π (–Ω–µ–≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π) –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä.

